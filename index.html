<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudySparkAI - Master Math with AI</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        .main-heading {
            font-size: 2.5rem;
            margin-bottom: 0.5em;
            text-align: center;
        }

        .sub-heading {
            font-size: 1.25rem;
            text-align: center;
            margin-bottom: 1em;
        }

        .cta-button {
            display: inline-block;
            padding: 0.75em 1.5em;
            font-size: 1.1rem;
            background-color: #ffd700;
            color: #333;
            text-decoration: none;
            border-radius: 6px;
            text-align: center;
            font-weight: bold;
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.4);
            transition: transform 0.2s;
        }

        .cta-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 215, 0, 0.6);
        }

        .tutor-step {
            margin: 20px 0;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .answer-btn:hover {
            background: #f0f4ff !important;
            border-color: #667eea !important;
            transform: translateY(-1px);
        }

        .correct-answer {
            background: #d4edda !important;
            border: 2px solid #28a745 !important;
            opacity: 1 !important;
        }

        .incorrect-answer {
            background: #f8d7da !important;
            border: 2px solid #dc3545 !important;
            opacity: 1 !important;
        }

        .explanation-box {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .step-box {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #667eea;
            font-family: 'Courier New', monospace;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 20px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 15px;
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .stat {
            text-align: center;
            color: white;
        }

        .stat-number {
            font-size: 1.8rem;
            font-weight: bold;
            display: block;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .main-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            margin-bottom: 20px;
        }

        .tab-nav {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .tab-btn {
            flex: 1;
            padding: 15px;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 500;
            color: #666;
            transition: all 0.3s;
        }

        .tab-btn.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
        }

        .tab-content {
            display: none;
            padding: 30px;
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: transform 0.2s;
            width: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-premium {
            background: linear-gradient(135deg, #ffd700 0%, #ffb347 100%);
            color: #333;
            font-weight: bold;
        }

        .premium-badge {
            background: linear-gradient(135deg, #ffd700 0%, #ffb347 100%);
            color: #333;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 8px;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .loading.show {
            display: block;
        }

        .ai-typing {
            display: none;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            margin: 20px 0;
        }

        .ai-typing.show {
            display: block;
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .dot {
            width: 8px;
            height: 8px;
            background: #667eea;
            border-radius: 50%;
            animation: typing 1.5s infinite;
        }

        .dot:nth-child(2) { animation-delay: 0.2s; }
        .dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }

        .study-plan {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .plan-day {
            background: white;
            margin: 10px 0;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .plan-day h4 {
            color: #667eea;
            margin-bottom: 8px;
        }

        .flashcards {
            display: grid;
            gap: 25px;
            margin: 20px 0;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }

        .flashcard {
            background: transparent;
            border-radius: 16px;
            height: 220px;
            cursor: pointer;
            perspective: 1200px;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
        }

        .flashcard:hover {
            transform: translateY(-8px) scale(1.02);
            filter: drop-shadow(0 20px 40px rgba(102, 126, 234, 0.3));
        }

        .flashcard.reviewed {
            opacity: 0.8;
            transform: scale(0.98);
        }

        .flashcard.reviewed::after {
            content: "✓";
            position: absolute;
            top: 10px;
            right: 15px;
            background: #28a745;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            z-index: 10;
            font-size: 16px;
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.4);
        }

        .flashcard-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform-style: preserve-3d;
        }

        .flashcard.flipped .flashcard-inner {
            transform: rotateY(180deg);
        }

        .flashcard-front, .flashcard-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 25px;
            border-radius: 16px;
            font-size: 18px;
            font-weight: 500;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .flashcard-front {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%, #f093fb 200%);
            color: white;
            position: relative;
            overflow: hidden;
        }

        .flashcard-front::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, transparent 50%, rgba(255,255,255,0.1) 100%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .flashcard:hover .flashcard-front::before {
            opacity: 1;
        }

        .flashcard-front::after {
            content: "💡";
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 24px;
            opacity: 0.7;
        }

        .flashcard-back {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            color: #333;
            transform: rotateY(180deg);
            border: 2px solid #667eea;
            position: relative;
        }

        .flashcard-back::after {
            content: "✨";
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 24px;
            opacity: 0.6;
        }

        .flashcard-progress {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 15px 0;
            padding: 15px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 12px;
            border: 1px solid #dee2e6;
        }

        .progress-ring {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: conic-gradient(#667eea 0deg, #667eea var(--progress), #e9ecef var(--progress), #e9ecef 360deg);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .progress-ring::before {
            content: '';
            width: 35px;
            height: 35px;
            background: white;
            border-radius: 50%;
            position: absolute;
        }

        .progress-text {
            position: absolute;
            font-size: 12px;
            font-weight: bold;
            color: #667eea;
            z-index: 1;
        }

        .flip-hint {
            position: absolute;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            opacity: 0.8;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 0.4; }
        }

        .flashcard.flipped .flip-hint {
            display: none;
        }

        .quiz {
            margin: 20px 0;
        }

        .question {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .question h4 {
            margin-bottom: 15px;
            color: #333;
        }

        .answers {
            display: grid;
            gap: 10px;
        }

        .answer {
            padding: 12px;
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .answer:hover {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .answer.selected {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }

        .answer.correct {
            border-color: #28a745;
            background: #d4edda;
            color: #155724;
        }

        .answer.incorrect {
            border-color: #dc3545;
            background: #f8d7da;
            color: #721c24;
        }

        .feedback {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px solid #e9ecef;
        }

        .rating {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            justify-content: center;
        }

        .star {
            font-size: 24px;
            color: #ddd;
            cursor: pointer;
            transition: color 0.2s;
        }

        .star:hover, .star.active {
            color: #ffc107;
        }

        .footer {
            text-align: center;
            color: white;
            margin-top: 30px;
            opacity: 0.8;
        }

        .testimonials {
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            color: white;
        }

        .testimonial {
            margin: 15px 0;
            padding: 15px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
        }

        .testimonial-text {
            font-style: italic;
            margin-bottom: 8px;
        }

        .testimonial-author {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .premium-preview {
            background: linear-gradient(135deg, #ffd700 0%, #ffb347 100%);
            color: #333;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .premium-features {
            display: grid;
            gap: 10px;
            margin: 15px 0;
        }

        .feature {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin: 20px 0;
        }

        .action-buttons .btn {
            flex: 1;
        }

        .dark-mode {
            background: #1a1a1a;
            color: #fff;
        }

        .dark-mode .main-card {
            background: #2d2d2d;
            color: #fff;
        }

        .dark-mode input, .dark-mode select, .dark-mode textarea {
            background: #3d3d3d;
            color: #fff;
            border-color: #555;
        }

        .dark-mode .plan-day, .dark-mode .question, .dark-mode .answer {
            background: #3d3d3d;
            color: #fff;
        }

        .dark-mode-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            font-size: 20px;
        }

        @keyframes flashSuccess {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); filter: brightness(1.1); }
            100% { transform: scale(1); }
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .main-heading {
                font-size: 2rem;
            }
            
            .sub-heading {
                font-size: 1.1rem;
            }
            
            .cta-button {
                font-size: 1rem;
                padding: 0.75em 1.25em;
            }
            
            .tab-content {
                padding: 20px;
            }

            .stats {
                gap: 15px;
            }

            .action-buttons {
                flex-direction: column;
            }
        }

        .hidden {
            display: none;
        }

        .score-display {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 8px;
            margin: 20px 0;
        }

        .progress-bar {
            background: #e9ecef;
            height: 8px;
            border-radius: 4px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-fill {
            background: #28a745;
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s;
        }

        .share-buttons {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }

        .share-btn {
            padding: 8px 16px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }

        .cta-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 215, 0, 0.6);
        }

        @keyframes countUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <button class="dark-mode-toggle" onclick="toggleDarkMode()" title="Toggle Dark Mode">🌙</button>

    <div class="container">
        <header class="header">
            <h1 class="main-heading">Stuck on a Math Topic?</h1>
            <p class="sub-heading">Get a clear, no-fluff explanation in seconds.</p>
            <p class="sub-heading">Perfect for high school students (ages 14-18) — when you just need it to <em>make sense</em>.</p>
            
            <a href="#generate-section" class="cta-button">Get Instant Help</a>
            
            <div class="beta-notice" style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; text-align: center; margin: 25px 0 20px 0;">
                <h3 style="color: #ffd700; margin-bottom: 8px;">🚧 BETA VERSION</h3>
                <p style="opacity: 0.9;">We're building the future of math help. Test it and help us improve!</p>
            </div>
        </header>

                <div class="feedback-section" style="background: rgba(255,255,255,0.1); border-radius: 12px; padding: 20px; margin: 20px 0; color: white;">
            <h3>💭 We'd Love Your Feedback!</h3>
            <p style="margin: 10px 0;">This is a beta version - we're actively building features based on what high school students actually need help with. What would make this more helpful when you're stuck?</p>
            <div style="display: flex; gap: 10px; margin-top: 15px; flex-wrap: wrap;">
                <button onclick="alert('Thanks! We\'re tracking this feedback.')" style="background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3); padding: 8px 16px; border-radius: 20px; cursor: pointer;">Step-by-step solutions</button>
                <button onclick="alert('Great suggestion! Adding to our roadmap.')" style="background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3); padding: 8px 16px; border-radius: 20px; cursor: pointer;">Video explanations</button>
                <button onclick="alert('Noted! We\'re working on this.')" style="background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3); padding: 8px 16px; border-radius: 20px; cursor: pointer;">Practice problems</button>
            </div>
        </div>

        <div class="main-card" id="generate-section">
            <nav class="tab-nav">
                <button class="tab-btn active" onclick="switchTab('generate')">Get Help</button>
                <button class="tab-btn" onclick="switchTab('manual')">Ask Question</button>
            </nav>

            <!-- AI Generation Tab -->
            <div id="generate" class="tab-content active">
                <form id="studyForm">
                    <div class="form-group">
                        <label for="topic">What math topic are you stuck on?</label>
                        <select id="topic" required>
                            <option disabled selected>Choose a topic you're stuck on</option>
                            <option value="algebra">Algebra – solving equations, working with graphs</option>
                            <option value="geometry">Geometry – shapes, angles, area and volume</option>
                            <option value="trigonometry">Trigonometry – triangles, sin/cos/tan</option>
                            <option value="calculus">Calculus – how things change (slopes, curves)</option>
                            <option value="statistics">Statistics – averages, probability, charts</option>
                            <option value="precalculus">Functions & Graphs – understanding inputs and outputs</option>
                            <option value="other">Other – I'll type my question instead</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="urgency">How urgent is this?</label>
                        <select id="urgency" required>
                            <option value="">Select urgency level</option>
                            <option value="test-tomorrow">Test tomorrow - HELP!</option>
                            <option value="homework-due">Homework due soon</option>
                            <option value="quiz-week">Quiz this week</option>
                            <option value="just-confused">Just confused, no rush</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="specific">What specifically confuses you? (optional)</label>
                        <input type="text" id="specific" placeholder="e.g., 'I don't get when to use the quadratic formula' or 'Why do we factor?'">
                    </div>

                    <button type="submit" class="btn" style="font-size: 1.2rem; padding: 16px 32px; margin-top: 10px;">🚀 Get Instant Help</button>
                </form>

                <div id="loading" class="loading">
                    <p>🤖 AI is creating your personalized explanation...</p>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0%"></div>
                    </div>
                </div>

                <div id="aiTyping" class="ai-typing">
                    <div class="typing-indicator">
                        <span>🤖 AI is breaking this down for you</span>
                        <div class="typing-dots">
                            <div class="dot"></div>
                            <div class="dot"></div>
                            <div class="dot"></div>
                        </div>
                    </div>
                    <div id="aiThoughts"></div>
                </div>
            </div>

            <!-- Manual Mode Tab -->
            <div id="manual" class="tab-content">
                <h3>Ask Your Own Question</h3>
                <p>Have a specific math problem? Describe it and get a clear explanation:</p>
                
                <div class="form-group">
                    <label for="customQuestion">Your Math Question</label>
                    <textarea id="customQuestion" rows="4" placeholder="e.g., 'How do I solve 2x + 5 = 13?' or 'I don't understand why we flip the inequality sign when dividing by negative numbers'"></textarea>
                </div>

                <button onclick="createManualAnswer()" class="btn">💡 Get Answer</button>
            </div>
        </div>

        <div style="background: linear-gradient(135deg, #ffd700 0%, #ffb347 100%); color: #333; padding: 12px 20px; border-radius: 8px; margin: 20px 0; text-align: center; font-size: 14px;">
            <span style="font-weight: bold;">🌟 Premium features coming soon</span> - 
            <button onclick="alert('Thanks for your interest! We\'ll email you when premium launches.')" style="background: #b8860b; color: white; border: none; padding: 4px 12px; border-radius: 15px; cursor: pointer; font-size: 13px; margin-left: 8px; font-weight: 500;">📧 Get notified</button>
        </div>

        <!-- Results Section -->
        <div id="results" class="hidden">
            <div class="main-card">
                <div class="tab-nav">
                    <button class="tab-btn active" onclick="switchResultTab('plan')">Explanation</button>
                    <button class="tab-btn" onclick="switchResultTab('flashcards')">Practice Cards</button>
                    <button class="tab-btn" onclick="switchResultTab('quiz')">Quick Quiz</button>
                    <button class="tab-btn" onclick="switchResultTab('feedback')">Feedback</button>
                </div>

                <!-- Explanation Results -->
                <div id="plan-tab" class="tab-content active">
                    <div id="studyPlanResults"></div>
                    <div class="action-buttons">
                        <button onclick="sharePlan()" class="btn">📤 Share This</button>
                        <button onclick="savePlan()" class="btn">💾 Save Help</button>
                        <button onclick="printPlan()" class="btn">🖨️ Print</button>
                    </div>
                </div>

                <!-- Practice Cards Results -->
                <div id="flashcards-tab" class="tab-content">
                    <h3>📚 Practice Cards</h3>
                    <p>Reinforce your understanding with these interactive flashcards!</p>
                    
                    <div class="flashcard-progress">
                        <div class="progress-ring" id="progressRing">
                            <div class="progress-text" id="progressText">0%</div>
                        </div>
                        <div>
                            <div style="font-weight: bold; color: #333;">Practice Progress</div>
                            <div id="cardProgress" style="color: #666;">0/10 cards reviewed</div>
                        </div>
                    </div>
                    
                    <div id="flashcardsResults" class="flashcards"></div>
                </div>

                <!-- Quiz Results -->
                <div id="quiz-tab" class="tab-content">
                    <h3>🧠 Knowledge Quiz <span class="premium-badge">PREMIUM</span></h3>
                    <p>Test your understanding with these practice questions:</p>
                    <div id="quizResults" class="quiz"></div>
                    <button id="checkAnswers" class="btn hidden" onclick="checkQuizAnswers()">Check Answers</button>
                    <div id="quizScore" class="score-display hidden"></div>
                </div>

                <!-- Feedback Tab -->
                <div id="feedback-tab" class="tab-content">
                    <div class="feedback">
                        <h3>💬 Rate Your Experience</h3>
                        <p>How helpful was this study plan?</p>
                        
                        <div class="rating" id="rating">
                            <span class="star" data-rating="1">⭐</span>
                            <span class="star" data-rating="2">⭐</span>
                            <span class="star" data-rating="3">⭐</span>
                            <span class="star" data-rating="4">⭐</span>
                            <span class="star" data-rating="5">⭐</span>
                        </div>

                        <div class="form-group">
                            <label for="suggestions">Suggestions for Improvement</label>
                            <textarea id="suggestions" rows="4" placeholder="What could we improve? Any specific features you'd like to see?"></textarea>
                        </div>

                        <button onclick="submitFeedback()" class="btn">Submit Feedback</button>
                    </div>
                </div>

                <button onclick="startOver()" class="btn" style="margin-top: 20px; background: #6c757d;">🔄 Create New Plan</button>
            </div>
        </div>

        <footer class="footer">
            <p>🚧 Beta Version - Free while we build and improve based on your feedback</p>
            <p>Help us create the perfect AI study companion for high school math ✨</p>
        </footer>
    </div>

    <script>
        let currentRating = 0;
        let currentTopic = '';
        let quizAnswers = [];
        let reviewedCards = new Set();
        let isDarkMode = false;

        // Real-world relevance stories for each topic
        const realWorldStories = {
            'algebra': {
                hook: "🎢 The same algebra you're learning designs roller coasters that thrill millions!",
                stories: [
                    "Engineers use quadratic equations to design the perfect parabolic loops in roller coasters - too steep and riders get hurt, too gentle and it's boring!",
                    "Netflix uses linear equations to predict which shows you'll binge-watch next based on your viewing patterns.",
                    "NASA scientists used algebra to calculate the exact trajectory needed to land rovers on Mars - one wrong equation and billions of dollars crash into space!",
                    "Spotify's algorithm uses algebraic formulas to create your Discover Weekly playlist by analyzing millions of listening patterns."
                ]
            },
            'geometry': {
                hook: "🏗️ Every building, bridge, and smartphone screen exists because of the geometry you're studying!",
                stories: [
                    "The Golden Gate Bridge uses triangle geometry principles to distribute weight - without these calculations, it would collapse!",
                    "Your iPhone screen uses precise geometric ratios to make apps look perfect at any size - designers call this 'responsive geometry.'",
                    "Architects use the Pythagorean theorem to ensure buildings don't fall down - every corner must be perfectly square or the structure fails.",
                    "Video game designers use 3D geometry to create realistic worlds in games like Fortnite and Minecraft."
                ]
            },
            'trigonometry': {
                hook: "📡 Every time you use GPS, you're using the same trig functions you're learning right now!",
                stories: [
                    "Your phone's GPS uses trigonometry to triangulate your exact location from satellite signals - without sin, cos, and tan, Google Maps couldn't exist!",
                    "Sound engineers use sine waves (trigonometry) to create the perfect acoustics in concert halls and recording studios.",
                    "Pilots use trigonometry to calculate flight paths, ensuring your plane lands safely at the right runway.",
                    "Animators at Pixar use trigonometric functions to create realistic water, fire, and hair movement in movies like Moana and Frozen."
                ]
            },
            'calculus': {
                hook: "🚀 The calculus you're learning is literally rocket science - it's what gets astronauts to space!",
                stories: [
                    "SpaceX uses calculus to calculate the exact fuel needed for rockets to escape Earth's gravity and reach the International Space Station.",
                    "Medical devices like MRI machines use calculus to convert radio waves into detailed images of your brain and organs.",
                    "Financial traders use calculus to predict stock market trends and make split-second trading decisions worth millions.",
                    "Tesla's self-driving cars use calculus to calculate optimal braking distances and steering angles to avoid accidents."
                ]
            },
            'statistics': {
                hook: "📊 Every major decision in the world - from your favorite TV shows to life-saving medicines - depends on statistics!",
                stories: [
                    "Pharmaceutical companies use statistics to prove new medicines are safe and effective before they can save lives - literally every drug you've ever taken passed statistical tests.",
                    "Netflix decides which shows to make based on statistical analysis of millions of viewing habits - your next favorite series exists because of statistics!",
                    "Sports teams use statistics to draft players and make game-time decisions - Moneyball revolutionized baseball using statistical analysis.",
                    "Climate scientists use statistical models to predict weather patterns and understand climate change impacts on our planet."
                ]
            },
            'precalculus': {
                hook: "🌐 Pre-calculus is the foundation that powers the internet, AI, and every smart device you use!",
                stories: [
                    "Search engines like Google use logarithmic functions to rank billions of web pages and show you the most relevant results in milliseconds.",
                    "AI systems like ChatGPT use exponential functions to process language and generate human-like responses.",
                    "Social media algorithms use composite functions to determine which posts appear in your feed based on your interests and behavior.",
                    "Cryptocurrency mining uses mathematical sequences and functions to secure blockchain networks and create digital money."
                ]
            }
        };

        // Enhanced sample data with more topics
        const samplePlans = {
            'algebra': {
                plan: [
                    { day: 1, task: "Master variables and basic expressions with visual diagrams", time: "30 min" },
                    { day: 2, task: "Solve linear equations using the balance method", time: "45 min" },
                    { day: 3, task: "Learn factoring patterns through interactive practice", time: "40 min" },
                    { day: 4, task: "Conquer quadratic equations with the quadratic formula", time: "50 min" },
                    { day: 5, task: "Apply algebra to real-world word problems", time: "35 min" },
                    { day: 6, task: "Graph linear functions and understand slope", time: "40 min" },
                    { day: 7, task: "Complete comprehensive review and practice test", time: "60 min" }
                ],
                flashcards: [
                    { front: "What is a variable?", back: "A symbol (usually a letter) that represents an unknown number" },
                    { front: "Solve: 2x + 3 = 11", back: "x = 4 (subtract 3, then divide by 2)" },
                    { front: "What is the quadratic formula?", back: "x = (-b ± √(b²-4ac)) / 2a" },
                    { front: "Factor: x² + 5x + 6", back: "(x + 2)(x + 3)" },
                    { front: "What is a coefficient?", back: "The number in front of a variable (like the 3 in 3x)" },
                    { front: "What is an exponent?", back: "A number that shows how many times to multiply the base by itself" },
                    { front: "What is FOIL?", back: "First, Outer, Inner, Last - method for multiplying binomials" },
                    { front: "What is slope?", back: "The steepness of a line, calculated as rise over run" },
                    { front: "What is y-intercept?", back: "The point where a line crosses the y-axis" },
                    { front: "Solve: x² - 4 = 0", back: "x = ±2 (difference of squares)" }
                ],
                quiz: [
                    {
                        question: "Solve for x: 3x - 7 = 14",
                        answers: ["x = 7", "x = 21", "x = 5", "x = 14"],
                        correct: 0
                    },
                    {
                        question: "What is the coefficient of x² in 5x² + 3x - 2?",
                        answers: ["3", "5", "-2", "x²"],
                        correct: 1
                    },
                    {
                        question: "Factor completely: x² + 7x + 12",
                        answers: ["(x + 3)(x + 4)", "(x + 2)(x + 6)", "(x + 1)(x + 12)", "Cannot be factored"],
                        correct: 0
                    },
                    {
                        question: "What is the slope of y = -2x + 5?",
                        answers: ["5", "-2", "2", "-5"],
                        correct: 1
                    },
                    {
                        question: "Solve using the quadratic formula: x² + 6x + 5 = 0",
                        answers: ["x = -1, -5", "x = 1, 5", "x = -2, -3", "x = 2, 3"],
                        correct: 0
                    }
                ]
            },
            'geometry': {
                plan: [
                    { day: 1, task: "Learn basic shapes, angles, and geometric vocabulary", time: "35 min" },
                    { day: 2, task: "Master triangle properties and angle relationships", time: "40 min" },
                    { day: 3, task: "Practice area and perimeter calculations", time: "45 min" },
                    { day: 4, task: "Understand coordinate geometry and distance formula", time: "40 min" },
                    { day: 5, task: "Learn geometric proofs and logical reasoning", time: "50 min" },
                    { day: 6, task: "Explore circles, arcs, and sector calculations", time: "45 min" },
                    { day: 7, task: "Review all concepts with mixed geometry problems", time: "55 min" }
                ],
                flashcards: [
                    { front: "What is the sum of angles in a triangle?", back: "180 degrees" },
                    { front: "Area of a circle formula", back: "A = πr² (pi times radius squared)" },
                    { front: "What is the Pythagorean theorem?", back: "a² + b² = c² (for right triangles)" },
                    { front: "What are parallel lines?", back: "Lines that never intersect and are always the same distance apart" },
                    { front: "Area of a rectangle", back: "A = length × width" },
                    { front: "What is a right angle?", back: "An angle that measures exactly 90 degrees" },
                    { front: "Circumference of a circle", back: "C = 2πr or C = πd" },
                    { front: "What is an isosceles triangle?", back: "A triangle with two equal sides and two equal angles" },
                    { front: "Volume of a rectangular prism", back: "V = length × width × height" },
                    { front: "What are vertical angles?", back: "Opposite angles formed by intersecting lines (they're equal)" }
                ],
                quiz: [
                    {
                        question: "What is the area of a triangle with base 6 and height 8?",
                        answers: ["24", "48", "14", "12"],
                        correct: 0
                    },
                    {
                        question: "In a right triangle, if one leg is 3 and the other is 4, what is the hypotenuse?",
                        answers: ["5", "7", "25", "12"],
                        correct: 0
                    },
                    {
                        question: "How many degrees are in a hexagon's interior angles total?",
                        answers: ["720°", "540°", "360°", "900°"],
                        correct: 0
                    },
                    {
                        question: "What is the area of a circle with radius 5?",
                        answers: ["25π", "10π", "5π", "50π"],
                        correct: 0
                    },
                    {
                        question: "If two parallel lines are cut by a transversal, alternate interior angles are:",
                        answers: ["Equal", "Supplementary", "Complementary", "Different"],
                        correct: 0
                    }
                ]
            },
            'trigonometry': {
                plan: [
                    { day: 1, task: "Master basic trigonometric ratios (sin, cos, tan) with memory tricks", time: "40 min" },
                    { day: 2, task: "Practice right triangle problems using SOHCAHTOA", time: "45 min" },
                    { day: 3, task: "Learn the unit circle and special angle values", time: "50 min" },
                    { day: 4, task: "Understand trigonometric identities and their applications", time: "45 min" },
                    { day: 5, task: "Graph sine, cosine, and tangent functions", time: "40 min" },
                    { day: 6, task: "Solve trigonometric equations step by step", time: "45 min" },
                    { day: 7, task: "Apply trig to real-world problems (navigation, physics)", time: "60 min" }
                ],
                flashcards: [
                    { front: "What is sin θ?", back: "Opposite side ÷ Hypotenuse (SOHCAHTOA)" },
                    { front: "What is cos θ?", back: "Adjacent side ÷ Hypotenuse" },
                    { front: "What is tan θ?", back: "Opposite ÷ Adjacent (or sin θ ÷ cos θ)" },
                    { front: "sin(30°) = ?", back: "1/2 or 0.5" },
                    { front: "cos(60°) = ?", back: "1/2 or 0.5" },
                    { front: "tan(45°) = ?", back: "1" },
                    { front: "Pythagorean identity", back: "sin²θ + cos²θ = 1" },
                    { front: "Period of sin(x)", back: "2π (360°)" },
                    { front: "sin(90°) = ?", back: "1" },
                    { front: "cos(0°) = ?", back: "1" }
                ],
                quiz: [
                    {
                        question: "In a right triangle, if opposite = 5 and hypotenuse = 13, what is sin θ?",
                        answers: ["5/13", "12/13", "5/12", "13/5"],
                        correct: 0
                    },
                    {
                        question: "What is cos(60°)?",
                        answers: ["1/2", "√3/2", "1", "√2/2"],
                        correct: 0
                    },
                    {
                        question: "If sin θ = 3/5 and θ is acute, what is cos θ?",
                        answers: ["4/5", "3/4", "5/4", "5/3"],
                        correct: 0
                    },
                    {
                        question: "What is the range of the sine function?",
                        answers: ["[-1, 1]", "[0, 1]", "[-π, π]", "All real numbers"],
                        correct: 0
                    },
                    {
                        question: "tan(45°) equals:",
                        answers: ["1", "√2", "1/2", "√3"],
                        correct: 0
                    }
                ]
            },
            'calculus': {
                plan: [
                    { day: 1, task: "Understand limits intuitively with graphical examples", time: "45 min" },
                    { day: 2, task: "Learn derivative rules: power, product, quotient, chain", time: "50 min" },
                    { day: 3, task: "Practice taking derivatives of polynomial functions", time: "45 min" },
                    { day: 4, task: "Apply derivatives to find slopes and rates of change", time: "40 min" },
                    { day: 5, task: "Introduction to integration as reverse differentiation", time: "50 min" },
                    { day: 6, task: "Practice basic integration techniques and u-substitution", time: "45 min" },
                    { day: 7, task: "Connect derivatives and integrals with fundamental theorem", time: "55 min" }
                ],
                flashcards: [
                    { front: "Derivative of x²", back: "2x" },
                    { front: "Derivative of sin(x)", back: "cos(x)" },
                    { front: "Derivative of eˣ", back: "eˣ (stays the same!)" },
                    { front: "Power rule", back: "d/dx[xⁿ] = nxⁿ⁻¹" },
                    { front: "Chain rule", back: "d/dx[f(g(x))] = f'(g(x)) · g'(x)" },
                    { front: "∫x dx = ?", back: "x²/2 + C" },
                    { front: "Derivative of ln(x)", back: "1/x" },
                    { front: "Product rule", back: "(fg)' = f'g + fg'" },
                    { front: "∫cos(x) dx = ?", back: "sin(x) + C" },
                    { front: "What does a derivative represent?", back: "Instantaneous rate of change or slope of tangent line" }
                ],
                quiz: [
                    {
                        question: "Find the derivative: f(x) = 4x³ - 2x + 7",
                        answers: ["12x² - 2", "12x² - 2x", "4x² - 2", "12x³ - 2"],
                        correct: 0
                    },
                    {
                        question: "What is lim(x→0) sin(x)/x?",
                        answers: ["1", "0", "∞", "undefined"],
                        correct: 0
                    },
                    {
                        question: "Using chain rule, find d/dx[sin(3x)]:",
                        answers: ["3cos(3x)", "cos(3x)", "3sin(3x)", "-3cos(3x)"],
                        correct: 0
                    },
                    {
                        question: "∫6x² dx = ?",
                        answers: ["2x³ + C", "6x + C", "18x + C", "6x³ + C"],
                        correct: 0
                    },
                    {
                        question: "At a critical point, f'(x) equals:",
                        answers: ["0", "1", "∞", "-1"],
                        correct: 0
                    }
                ]
            },
            'statistics': {
                plan: [
                    { day: 1, task: "Learn data types and measures of central tendency", time: "35 min" },
                    { day: 2, task: "Calculate mean, median, mode with real datasets", time: "40 min" },
                    { day: 3, task: "Understand standard deviation and variance", time: "45 min" },
                    { day: 4, task: "Create and interpret graphs (histograms, box plots)", time: "40 min" },
                    { day: 5, task: "Basic probability rules and calculations", time: "45 min" },
                    { day: 6, task: "Normal distribution and z-scores", time: "50 min" },
                    { day: 7, task: "Practice with real-world statistical analysis", time: "55 min" }
                ],
                flashcards: [
                    { front: "What is the mean?", back: "The average: sum of all values ÷ number of values" },
                    { front: "What is the median?", back: "The middle value when data is arranged in order" },
                    { front: "What is the mode?", back: "The value that appears most frequently" },
                    { front: "What is standard deviation?", back: "A measure of how spread out data points are from the mean" },
                    { front: "Probability formula", back: "P(event) = favorable outcomes ÷ total outcomes" },
                    { front: "What is a normal distribution?", back: "A bell-shaped curve where most data clusters around the mean" },
                    { front: "What is a z-score?", back: "How many standard deviations a value is from the mean" },
                    { front: "Range formula", back: "Maximum value - Minimum value" },
                    { front: "What is correlation?", back: "A measure of how two variables are related" },
                    { front: "Sample vs Population", back: "Sample is part of population; population is entire group" }
                ],
                quiz: [
                    {
                        question: "Find the mean of: 2, 4, 6, 8, 10",
                        answers: ["6", "5", "7", "8"],
                        correct: 0
                    },
                    {
                        question: "If you flip a fair coin twice, what's P(two heads)?",
                        answers: ["1/4", "1/2", "1/3", "2/3"],
                        correct: 0
                    },
                    {
                        question: "In a normal distribution, about what % of data falls within 1 standard deviation?",
                        answers: ["68%", "95%", "99.7%", "50%"],
                        correct: 0
                    },
                    {
                        question: "What is the median of: 1, 3, 5, 7, 9, 11?",
                        answers: ["6", "5", "7", "8"],
                        correct: 0
                    },
                    {
                        question: "If P(A) = 0.3 and P(B) = 0.4, and A and B are independent, what is P(A and B)?",
                        answers: ["0.12", "0.7", "0.1", "0.24"],
                        correct: 0
                    }
                ]
            },
            'precalculus': {
                plan: [
                    { day: 1, task: "Review and extend function notation and operations", time: "40 min" },
                    { day: 2, task: "Master polynomial and rational functions", time: "45 min" },
                    { day: 3, task: "Understand exponential and logarithmic functions", time: "50 min" },
                    { day: 4, task: "Learn about limits and continuity concepts", time: "45 min" },
                    { day: 5, task: "Practice with inverse functions and compositions", time: "40 min" },
                    { day: 6, task: "Explore sequences, series, and mathematical induction", time: "50 min" },
                    { day: 7, task: "Comprehensive review preparing for calculus", time: "60 min" }
                ],
                flashcards: [
                    { front: "What is function notation?", back: "f(x) represents the output when x is the input" },
                    { front: "Domain of a function", back: "All possible input values (x-values)" },
                    { front: "Range of a function", back: "All possible output values (y-values)" },
                    { front: "What is an asymptote?", back: "A line that a function approaches but never touches" },
                    { front: "e ≈ ?", back: "2.718... (Euler's number)" },
                    { front: "log₁₀(100) = ?", back: "2 (because 10² = 100)" },
                    { front: "What is a composite function?", back: "(f∘g)(x) = f(g(x)) - function inside a function" },
                    { front: "What is an inverse function?", back: "f⁻¹(x) 'undoes' what f(x) does" },
                    { front: "Limit definition", back: "The value a function approaches as x approaches a certain value" },
                    { front: "Arithmetic sequence formula", back: "aₙ = a₁ + (n-1)d" }
                ],
                quiz: [
                    {
                        question: "If f(x) = 2x + 3, what is f(5)?",
                        answers: ["13", "11", "8", "10"],
                        correct: 0
                    },
                    {
                        question: "What is the domain of f(x) = 1/(x-2)?",
                        answers: ["All real numbers except x = 2", "All real numbers", "x > 2", "x < 2"],
                        correct: 0
                    },
                    {
                        question: "Solve: log₂(8) = ?",
                        answers: ["3", "2", "4", "8"],
                        correct: 0
                    },
                    {
                        question: "If f(x) = x² and g(x) = x + 1, what is (f∘g)(2)?",
                        answers: ["9", "5", "6", "7"],
                        correct: 0
                    },
                    {
                        question: "What is lim(x→3) (x² - 9)/(x - 3)?",
                        answers: ["6", "0", "3", "undefined"],
                        correct: 0
                    }
                ]
            }
        };

        // AI thoughts for different urgency levels
        const aiThoughts = {
            'test-tomorrow': [
                "Detecting high urgency - focusing on key concepts only...",
                "Prioritizing the most important points for quick understanding...",
                "Creating focused explanation to help you fast...",
                "Skipping extra details - just what you need to know..."
            ],
            'homework-due': [
                "Understanding your homework deadline pressure...",
                "Creating clear step-by-step explanation...",
                "Focusing on practical application for your assignment...",
                "Making sure you understand the 'why' behind the steps..."
            ],
            'quiz-week': [
                "Preparing comprehensive explanation for your upcoming quiz...",
                "Including practice elements to test understanding...",
                "Building from basics to ensure solid foundation...",
                "Adding memory tricks to help concepts stick..."
            ],
            'just-confused': [
                "Taking time to build understanding from the ground up...",
                "Connecting this concept to things you already know...",
                "Including real-world examples to make it click...",
                "Making sure every step makes logical sense..."
            ]
        };

        // Counter animation - removed for beta
        function animateCounters() {
            // Disabled for beta version
        }

        // Start counter animation when page loads
        window.addEventListener('load', animateCounters);

        function switchTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tab).classList.add('active');
        }

        function switchResultTab(tab) {
            document.querySelectorAll('#results .tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('#results .tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tab + '-tab').classList.add('active');
        }

        document.getElementById('studyForm').addEventListener('submit', function(e) {
            e.preventDefault();
            generateStudyPlan();
        });

        function generateStudyPlan() {
            const topic = document.getElementById('topic').value;
            const urgency = document.getElementById('urgency').value;
            const specific = document.getElementById('specific').value;

            currentTopic = topic;

            // Show loading
            document.getElementById('loading').classList.add('show');
            
            // Simulate AI processing with progress bar
            let progress = 0;
            const progressBar = document.querySelector('.progress-fill');
            const progressInterval = setInterval(() => {
                progress += Math.random() * 15 + 5;
                if (progress > 100) progress = 100;
                progressBar.style.width = progress + '%';
                
                if (progress >= 100) {
                    clearInterval(progressInterval);
                    setTimeout(() => {
                        showAITyping(urgency);
                    }, 500);
                }
            }, 300);
        }

        function showAITyping(urgency) {
            document.getElementById('loading').classList.remove('show');
            document.getElementById('aiTyping').classList.add('show');
            
            const thoughts = aiThoughts[urgency] || aiThoughts['just-confused'];
            const thoughtsDiv = document.getElementById('aiThoughts');
            let currentThought = 0;
            
            function showNextThought() {
                if (currentThought < thoughts.length) {
                    thoughtsDiv.innerHTML += `<div style="margin: 10px 0; opacity: 0.7;">💭 ${thoughts[currentThought]}</div>`;
                    currentThought++;
                    setTimeout(showNextThought, 1500);
                } else {
                    setTimeout(() => {
                        document.getElementById('aiTyping').classList.remove('show');
                        showResults(document.getElementById('topic').value, urgency, document.getElementById('specific').value);
                    }, 1000);
                }
            }
            
            setTimeout(showNextThought, 1000);
        }

        function showResults(topic, urgency, specific) {
            // Find matching topic data
            let topicData = samplePlans[topic] || samplePlans['algebra'];

            // If it's algebra, show the interactive tutor flow
            if (topic === 'algebra') {
                generateInteractiveTutorFlow(urgency, specific);
            } else {
                // Generate regular explanation for other topics
                generateExplanationDisplay(topicData, topic, urgency, specific);
                generateFlashcards(topicData.flashcards);
                generateQuiz(topicData.quiz);
            }
            
            // Show results section
            document.getElementById('results').classList.remove('hidden');
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
            
            // Show feedback prompt after a delay
            setTimeout(() => {
                showFeedbackPrompt();
            }, 3000);
        }

        function generateInteractiveTutorFlow(urgency, specific) {
            const container = document.getElementById('studyPlanResults');
            
            let urgencyIntro = "";
            switch(urgency) {
                case 'test-tomorrow':
                    urgencyIntro = "🚨 Test tomorrow? Let's practice the most essential algebra skill: solving linear equations!";
                    break;
                case 'homework-due':
                    urgencyIntro = "📝 Homework help? Let's master linear equations step-by-step!";
                    break;
                case 'quiz-week':
                    urgencyIntro = "📚 Quiz prep? Perfect - linear equations are fundamental to everything else!";
                    break;
                default:
                    urgencyIntro = "🎯 Let's learn algebra the right way - by actually doing it!";
            }
            
            container.innerHTML = `
                <div id="tutorFlow">
                    <h3>🤖 Interactive AI Tutor: Linear Equations</h3>
                    ${specific ? `<p style="color: #666; font-style: italic;">Addressing your question: "${specific}"</p>` : ''}
                    
                    <div style="background: #e3f2fd; border-left: 4px solid #2196f3; padding: 15px; margin: 20px 0; border-radius: 0 8px 8px 0;">
                        <p><strong>${urgencyIntro}</strong></p>
                    </div>

                    <!-- Step 1: Daily Concept -->
                    <div id="step1" class="tutor-step">
                        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 12px; margin: 20px 0;">
                            <h4>📘 Today's Concept: Solving Linear Equations</h4>
                            <p style="font-size: 1.1em; margin: 10px 0;">A linear equation with one variable looks like: <strong>2x + 3 = 11</strong></p>
                            <p>Our goal: Find the value of <strong>x</strong> that makes this equation true!</p>
                            <button onclick="startPractice()" style="background: #ffd700; color: #333; border: none; padding: 12px 24px; border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 15px;">Let's Practice! 🚀</button>
                        </div>
                    </div>

                    <!-- Step 2: Practice Question (hidden initially) -->
                    <div id="step2" class="tutor-step" style="display: none;">
                        <div style="background: #f8f9fa; border: 2px solid #667eea; border-radius: 12px; padding: 25px; margin: 20px 0;">
                            <h4 style="color: #667eea; margin-bottom: 15px;">🧮 Practice Question</h4>
                            <p style="font-size: 1.2em; margin-bottom: 20px;"><strong>What is the value of x in: 2x + 3 = 11?</strong></p>
                            
                            <div style="display: grid; gap: 10px; max-width: 400px;">
                                <button class="answer-btn" onclick="checkAnswer('A', 3, this)" style="padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; background: white; cursor: pointer; text-align: left; transition: all 0.3s; font-size: 16px;">A. x = 3</button>
                                <button class="answer-btn" onclick="checkAnswer('B', 4, this)" style="padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; background: white; cursor: pointer; text-align: left; transition: all 0.3s; font-size: 16px;">B. x = 4</button>
                                <button class="answer-btn" onclick="checkAnswer('C', 5, this)" style="padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; background: white; cursor: pointer; text-align: left; transition: all 0.3s; font-size: 16px;">C. x = 5</button>
                                <button class="answer-btn" onclick="checkAnswer('D', 6, this)" style="padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; background: white; cursor: pointer; text-align: left; transition: all 0.3s; font-size: 16px;">D. x = 6</button>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: AI Explanation (hidden initially) -->
                    <div id="step3" class="tutor-step" style="display: none;">
                        <div id="explanationContent" class="explanation-box">
                            <!-- Content will be populated by answer functions -->
                        </div>
                    </div>

                    <!-- Step 4: Real-world Connection (hidden initially) -->
                    <div id="step4" class="tutor-step" style="display: none;">
                        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; border-radius: 12px; margin: 20px 0;">
                            <h4 style="margin-bottom: 15px;">🌟 Real-World Connection</h4>
                            <p style="font-size: 1.1em; margin-bottom: 15px;"><strong>Did you know?</strong> Solving linear equations is exactly how Netflix fine-tunes its recommendation engine!</p>
                            <p style="margin-bottom: 15px;">Netflix learns from what you watch and solves millions of equations like this to predict what you'll like next. Every time you rate a movie, you're giving Netflix data points to solve for your preferences!</p>
                            <button onclick="showProgress()" style="background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3); padding: 10px 20px; border-radius: 8px; cursor: pointer; transition: all 0.3s;">Cool! What's next? →</button>
                        </div>
                    </div>

                    <!-- Step 5: Progress (hidden initially) -->
                    <div id="step5" class="tutor-step" style="display: none;">
                        <div style="background: #f8f9fa; border: 2px solid #28a745; border-radius: 12px; padding: 25px; margin: 20px 0; text-align: center;">
                            <h4 style="color: #28a745; margin-bottom: 20px;">🎉 Great Job!</h4>
                            <div style="display: flex; align-items: center; justify-content: center; gap: 15px; margin: 20px 0;">
                                <div style="background: #28a745; color: white; width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold;">1</div>
                                <div style="width: 60px; height: 4px; background: #e9ecef; border-radius: 2px; position: relative;">
                                    <div style="width: 20%; height: 100%; background: #28a745; border-radius: 2px;"></div>
                                </div>
                                <div style="background: #e9ecef; color: #666; width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center;">5</div>
                            </div>
                            <p style="margin-bottom: 10px;"><strong>Progress:</strong> 1/5 questions completed for today</p>
                            <p style="color: #28a745; margin-bottom: 20px;">💡 <strong>Flashcard unlocked:</strong> "How to solve ax + b = c"</p>
                            <div style="display: flex; gap: 10px; justify-content: center;">
                                <button onclick="nextQuestion()" style="background: #667eea; color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; font-weight: bold;">📚 Next Question</button>
                                <button onclick="viewFlashcard()" style="background: #28a745; color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; font-weight: bold;">🎴 View Flashcard</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function startPractice() {
            document.getElementById('step2').style.display = 'block';
            document.getElementById('step2').scrollIntoView({ behavior: 'smooth' });
        }

        function checkAnswer(letter, value, buttonElement) {
            // Disable all buttons after selection
            const buttons = document.querySelectorAll('.answer-btn');
            buttons.forEach(btn => {
                btn.disabled = true;
                btn.style.cursor = 'not-allowed';
                btn.style.opacity = '0.7';
            });
            
            // Show correct answer (B. x = 4)
            buttons[1].style.background = '#d4edda';
            buttons[1].style.border = '2px solid #28a745';
            buttons[1].style.opacity = '1';
            
            // If they selected wrong answer, highlight it in red
            if (letter !== 'B') {
                buttonElement.style.background = '#f8d7da';
                buttonElement.style.border = '2px solid #dc3545';
                buttonElement.style.opacity = '1';
            }
            
            // Show explanation with correct/incorrect message
            let explanationHtml;
            if (value === 4) {
                explanationHtml = `
                    <h4 style="color: #28a745;">✅ Correct! Excellent work!</h4>
                    <p><strong>Here's the step-by-step solution:</strong></p>
                    <div style="background: white; padding: 15px; border-radius: 8px; margin: 15px 0; font-family: monospace; border-left: 4px solid #28a745;">
                        <p><strong>Step 1:</strong> 2x + 3 = 11</p>
                        <p><strong>Step 2:</strong> Subtract 3 from both sides → 2x = 8</p>
                        <p><strong>Step 3:</strong> Divide both sides by 2 → x = 4</p>
                    </div>
                    <p><strong>Key concept:</strong> We <em>isolate the variable</em> by reversing the operations!</p>
                    <button onclick="nextQuestion()" style="background: #667eea; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; margin-top: 15px; font-weight: bold;">📚 Next Question</button>
                `;
            } else {
                explanationHtml = `
                    <h4 style="color: #dc3545;">❌ Not quite! The correct answer is B. x = 4</h4>
                    <p><strong>No worries - here's how to solve it:</strong></p>
                    <div style="background: white; padding: 15px; border-radius: 8px; margin: 15px 0; font-family: monospace; border-left: 4px solid #dc3545;">
                        <p><strong>Step 1:</strong> 2x + 3 = 11</p>
                        <p><strong>Step 2:</strong> Subtract 3 from both sides → 2x = 8</p>
                        <p><strong>Step 3:</strong> Divide both sides by 2 → x = 4</p>
                    </div>
                    <p><strong>Remember:</strong> To isolate x, we reverse the operations. Since we have +3, we subtract 3. Since we have 2x (multiply by 2), we divide by 2.</p>
                    <button onclick="nextQuestion()" style="background: #667eea; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; margin-top: 15px; font-weight: bold;">📚 Try Another Question</button>
                `;
            }
            
            document.getElementById('explanationContent').innerHTML = explanationHtml;
            document.getElementById('step3').style.display = 'block';
            document.getElementById('step3').scrollIntoView({ behavior: 'smooth' });
            
            // Show real-world connection after 2 seconds
            setTimeout(() => {
                document.getElementById('step4').style.display = 'block';
                document.getElementById('step4').scrollIntoView({ behavior: 'smooth' });
            }, 2000);
        }

        let questionCount = 1;
        const mathQuestions = [
            { equation: "2x + 3 = 11", answers: ["x = 3", "x = 4", "x = 5", "x = 6"], correct: 1, solution: { step1: "2x + 3 = 11", step2: "Subtract 3 from both sides → 2x = 8", step3: "Divide both sides by 2 → x = 4" }},
            { equation: "3x - 5 = 16", answers: ["x = 5", "x = 6", "x = 7", "x = 8"], correct: 2, solution: { step1: "3x - 5 = 16", step2: "Add 5 to both sides → 3x = 21", step3: "Divide both sides by 3 → x = 7" }},
            { equation: "4x + 1 = 25", answers: ["x = 5", "x = 6", "x = 7", "x = 8"], correct: 1, solution: { step1: "4x + 1 = 25", step2: "Subtract 1 from both sides → 4x = 24", step3: "Divide both sides by 4 → x = 6" }},
            { equation: "5x - 3 = 22", answers: ["x = 4", "x = 5", "x = 6", "x = 7"], correct: 1, solution: { step1: "5x - 3 = 22", step2: "Add 3 to both sides → 5x = 25", step3: "Divide both sides by 5 → x = 5" }}
        ];

        function nextQuestion() {
            if (questionCount >= mathQuestions.length) {
                // Reset to first question after completing all
                questionCount = 0;
            }
            
            const currentQ = mathQuestions[questionCount];
            questionCount++;
            
            // Update the question display
            const questionHTML = `
                <div style="background: #f8f9fa; border: 2px solid #667eea; border-radius: 12px; padding: 25px; margin: 20px 0;">
                    <h4 style="color: #667eea; margin-bottom: 15px;">🧮 Practice Question ${questionCount}</h4>
                    <p style="font-size: 1.2em; margin-bottom: 20px;"><strong>What is the value of x in: ${currentQ.equation}?</strong></p>
                    
                    <div style="display: grid; gap: 10px; max-width: 400px;">
                        <button class="answer-btn" onclick="checkNewAnswer('A', 0, this, ${questionCount-1})" style="padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; background: white; cursor: pointer; text-align: left; transition: all 0.3s; font-size: 16px;">A. ${currentQ.answers[0]}</button>
                        <button class="answer-btn" onclick="checkNewAnswer('B', 1, this, ${questionCount-1})" style="padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; background: white; cursor: pointer; text-align: left; transition: all 0.3s; font-size: 16px;">B. ${currentQ.answers[1]}</button>
                        <button class="answer-btn" onclick="checkNewAnswer('C', 2, this, ${questionCount-1})" style="padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; background: white; cursor: pointer; text-align: left; transition: all 0.3s; font-size: 16px;">C. ${currentQ.answers[2]}</button>
                        <button class="answer-btn" onclick="checkNewAnswer('D', 3, this, ${questionCount-1})" style="padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; background: white; cursor: pointer; text-align: left; transition: all 0.3s; font-size: 16px;">D. ${currentQ.answers[3]}</button>
                    </div>
                </div>
            `;
            
            // Replace the question area
            document.getElementById('step2').innerHTML = questionHTML;
            
            // Hide explanation and real-world sections
            document.getElementById('step3').style.display = 'none';
            document.getElementById('step4').style.display = 'none';
            document.getElementById('step5').style.display = 'none';
            
            // Scroll back to the new question
            document.getElementById('step2').scrollIntoView({ behavior: 'smooth' });
        }

        function checkNewAnswer(letter, answerIndex, buttonElement, questionIndex) {
            const currentQ = mathQuestions[questionIndex];
            const isCorrect = answerIndex === currentQ.correct;
            
            // Disable all buttons after selection
            const buttons = document.querySelectorAll('.answer-btn');
            buttons.forEach(btn => {
                btn.disabled = true;
                btn.style.cursor = 'not-allowed';
                btn.style.opacity = '0.7';
            });
            
            // Show correct answer
            buttons[currentQ.correct].classList.add('correct-answer');
            
            // If they selected wrong answer, highlight it in red
            if (!isCorrect) {
                buttonElement.classList.add('incorrect-answer');
            }
            
            // Show explanation
            let explanationHtml;
            if (isCorrect) {
                explanationHtml = `
                    <h4 style="color: #28a745; margin-bottom: 15px;">✅ Correct! Excellent work!</h4>
                    <p style="margin-bottom: 15px;"><strong>Here's the step-by-step solution:</strong></p>
                    <div class="step-box">
                        <p><strong>Step 1:</strong> ${currentQ.solution.step1}</p>
                        <p><strong>Step 2:</strong> ${currentQ.solution.step2}</p>
                        <p><strong>Step 3:</strong> ${currentQ.solution.step3}</p>
                    </div>
                    <p style="color: #666; margin-bottom: 20px;"><strong>Key concept:</strong> We <em>isolate the variable</em> by reversing the operations!</p>
                    <button onclick="nextQuestion()" style="background: #667eea; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: bold; transition: all 0.3s;">📚 Next Question</button>
                `;
            } else {
                explanationHtml = `
                    <h4 style="color: #dc3545; margin-bottom: 15px;">❌ Not quite! The correct answer is ${String.fromCharCode(65 + currentQ.correct)}. ${currentQ.answers[currentQ.correct]}</h4>
                    <p style="margin-bottom: 15px;"><strong>No worries - here's how to solve it:</strong></p>
                    <div class="step-box">
                        <p><strong>Step 1:</strong> ${currentQ.solution.step1}</p>
                        <p><strong>Step 2:</strong> ${currentQ.solution.step2}</p>
                        <p><strong>Step 3:</strong> ${currentQ.solution.step3}</p>
                    </div>
                    <p style="color: #666; margin-bottom: 20px;"><strong>Remember:</strong> To isolate x, we reverse the operations step by step.</p>
                    <button onclick="nextQuestion()" style="background: #667eea; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: bold; transition: all 0.3s;">📚 Try Another Question</button>
                `;
            }
            
            document.getElementById('explanationContent').innerHTML = explanationHtml;
            document.getElementById('step3').style.display = 'block';
            document.getElementById('step3').scrollIntoView({ behavior: 'smooth' });
            
            // Show real-world connection after 2 seconds
            setTimeout(() => {
                document.getElementById('step4').style.display = 'block';
                document.getElementById('step4').scrollIntoView({ behavior: 'smooth' });
            }, 2000);
        }

        function showProgress() {
            document.getElementById('step5').style.display = 'block';
            document.getElementById('step5').scrollIntoView({ behavior: 'smooth' });
        }

        function nextQuestion() {
            // This function is now handled by the new nextQuestion() above
            if (questionCount >= mathQuestions.length) {
                questionCount = 0;
            }
            
            const currentQ = mathQuestions[questionCount];
            questionCount++;
            
            // Update the question display with new question
            const questionHTML = `
                <div style="background: #f8f9fa; border: 2px solid #667eea; border-radius: 12px; padding: 25px; margin: 20px 0;">
                    <h4 style="color: #667eea; margin-bottom: 15px;">🧮 Practice Question ${questionCount}</h4>
                    <p style="font-size: 1.2em; margin-bottom: 20px;"><strong>What is the value of x in: ${currentQ.equation}?</strong></p>
                    
                    <div style="display: grid; gap: 10px; max-width: 400px;">
                        <button class="answer-btn" onclick="checkNewAnswer('A', 0, this, ${questionCount-1})" style="padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; background: white; cursor: pointer; text-align: left; transition: all 0.3s; font-size: 16px;">A. ${currentQ.answers[0]}</button>
                        <button class="answer-btn" onclick="checkNewAnswer('B', 1, this, ${questionCount-1})" style="padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; background: white; cursor: pointer; text-align: left; transition: all 0.3s; font-size: 16px;">B. ${currentQ.answers[1]}</button>
                        <button class="answer-btn" onclick="checkNewAnswer('C', 2, this, ${questionCount-1})" style="padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; background: white; cursor: pointer; text-align: left; transition: all 0.3s; font-size: 16px;">C. ${currentQ.answers[2]}</button>
                        <button class="answer-btn" onclick="checkNewAnswer('D', 3, this, ${questionCount-1})" style="padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; background: white; cursor: pointer; text-align: left; transition: all 0.3s; font-size: 16px;">D. ${currentQ.answers[3]}</button>
                    </div>
                </div>
            `;
            
            // Replace the question area
            document.getElementById('step2').innerHTML = questionHTML;
            
            // Hide explanation and other sections
            document.getElementById('step3').style.display = 'none';
            document.getElementById('step4').style.display = 'none';
            document.getElementById('step5').style.display = 'none';
            
            // Scroll to new question
            document.getElementById('step2').scrollIntoView({ behavior: 'smooth' });
        }

        function viewFlashcard() {
            alert('🎴 Flashcard: "To solve ax + b = c, subtract b from both sides, then divide by a"');
        }

        function showFeedbackPrompt() {
            const prompt = document.createElement('div');
            prompt.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                background: #667eea;
                color: white;
                padding: 15px 20px;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                z-index: 1000;
                max-width: 300px;
                animation: slideIn 0.5s ease-out;
            `;
            prompt.innerHTML = `
                <div style="margin-bottom: 10px; font-weight: bold;">💭 Was this helpful?</div>
                <div style="margin-bottom: 15px; font-size: 14px;">What else would've made it easier?</div>
                <div style="display: flex; gap: 5px; flex-wrap: wrap;">
                    <button onclick="feedbackClick('step-by-step')" style="background: rgba(255,255,255,0.2); border: none; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px; cursor: pointer;">More steps</button>
                    <button onclick="feedbackClick('examples')" style="background: rgba(255,255,255,0.2); border: none; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px; cursor: pointer;">More examples</button>
                    <button onclick="feedbackClick('practice')" style="background: rgba(255,255,255,0.2); border: none; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px; cursor: pointer;">More practice</button>
                </div>
                <button onclick="this.parentElement.remove()" style="position: absolute; top: 5px; right: 8px; background: none; border: none; color: white; cursor: pointer;">×</button>
            `;
            
            // Add animation keyframe
            if (!document.querySelector('#slideInAnimation')) {
                const style = document.createElement('style');
                style.id = 'slideInAnimation';
                style.textContent = `
                    @keyframes slideIn {
                        from { transform: translateX(100%); opacity: 0; }
                        to { transform: translateX(0); opacity: 1; }
                    }
                `;
                document.head.appendChild(style);
            }
            
            document.body.appendChild(prompt);
        }

        function feedbackClick(type) {
            alert(`Thanks! "${type}" feedback noted - we're building this!`);
            document.querySelector('[style*="position: fixed"]').remove();
        }

        function generateExplanationDisplay(topicData, topic, urgency, specific) {
            const container = document.getElementById('studyPlanResults');
            const stories = realWorldStories[topic] || realWorldStories['algebra'];
            
            // Create urgency-based explanation
            let urgencyMessage = "";
            let actionItems = [];
            
            switch(urgency) {
                case 'test-tomorrow':
                    urgencyMessage = "🚨 Test tomorrow? Let's focus on the essentials:";
                    actionItems = [
                        "Review the key formula/concept below",
                        "Do 3-5 practice problems to test understanding", 
                        "Focus on the most common question types",
                        "Don't try to learn everything - master the basics"
                    ];
                    break;
                case 'homework-due':
                    urgencyMessage = "📝 Homework help - here's your step-by-step approach:";
                    actionItems = [
                        "Understand the concept with our explanation",
                        "Work through the example problems",
                        "Apply the same steps to your homework",
                        "Check your work with our practice quiz"
                    ];
                    break;
                case 'quiz-week':
                    urgencyMessage = "📚 Quiz prep - comprehensive understanding:";
                    actionItems = [
                        "Learn the concept thoroughly below",
                        "Practice with our flashcards",
                        "Take the practice quiz",
                        "Review any mistakes until you understand"
                    ];
                    break;
                default:
                    urgencyMessage = "🎯 Let's break this down clearly:";
                    actionItems = [
                        "Start with the real-world context below",
                        "Follow our step-by-step explanation", 
                        "Practice with flashcards to reinforce",
                        "Test yourself with the quiz"
                    ];
            }
            
            let html = `
                <h3>💡 ${topic.charAt(0).toUpperCase() + topic.slice(1)} Help</h3>
                ${specific ? `<p><strong>Your specific question:</strong> "${specific}"</p>` : ''}
                
                <div style="background: #e3f2fd; border-left: 4px solid #2196f3; padding: 15px; margin: 20px 0; border-radius: 0 8px 8px 0;">
                    <h4>${urgencyMessage}</h4>
                    <ol style="margin: 10px 0 0 20px;">
                        ${actionItems.map(item => `<li style="margin: 5px 0;">${item}</li>`).join('')}
                    </ol>
                </div>

                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <h4>🌟 Why This Actually Matters</h4>
                    <p style="font-size: 1.1em; margin: 10px 0;"><strong>${stories.hook}</strong></p>
                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 6px; margin: 10px 0;">
                        <p><strong>💡 Real example:</strong> ${stories.stories[Math.floor(Math.random() * stories.stories.length)]}</p>
                    </div>
                </div>

                <div class="study-plan">
                    <h4>📖 Step-by-Step Explanation</h4>
                    <div class="plan-day">
                        <h4>Key Concept</h4>
                        <p>${topicData.plan[0].task}</p>
                        <small>💡 This is the foundation - make sure you understand this first</small>
                    </div>
                    <div class="plan-day">
                        <h4>How to Apply It</h4>
                        <p>${topicData.plan[1].task}</p>
                        <small>🔧 Practice this method until it feels automatic</small>
                    </div>
                    <div class="plan-day">
                        <h4>Common Mistakes to Avoid</h4>
                        <p>Don't rush through the steps - most errors happen when you skip the basics</p>
                        <small>⚠️ Take your time with each step</small>
                    </div>
                </div>

                <div style="background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 8px; padding: 20px; margin: 30px 0; text-align: center;">
                    <h4 style="margin-bottom: 15px; color: #333;">Was this explanation helpful?</h4>
                    <div style="display: flex; gap: 15px; justify-content: center; margin-bottom: 15px;">
                        <button onclick="quickFeedback('yes')" style="background: #28a745; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">✅ Yes, it helped!</button>
                        <button onclick="quickFeedback('no')" style="background: #dc3545; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">❌ No, still confused</button>
                    </div>
                    <div id="followUpFeedback" style="display: none; margin-top: 15px;">
                        <p style="margin-bottom: 10px; color: #666;">What didn't work for you?</p>
                        <textarea id="feedbackText" placeholder="e.g., 'Too complicated', 'Need more examples', 'Explain it differently'..." style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; resize: vertical;" rows="3"></textarea>
                        <button onclick="submitDetailedFeedback()" style="background: #667eea; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; margin-top: 10px;">Send Feedback</button>
                    </div>
                </div>
            `;
            
            container.innerHTML = html;
        }

        function quickFeedback(response) {
            if (response === 'yes') {
                alert('🎉 Awesome! Thanks for the feedback. This helps us improve.');
                // Hide the feedback section
                document.querySelector('[style*="background: #f8f9fa"]').style.display = 'none';
            } else {
                // Show the follow-up question
                document.getElementById('followUpFeedback').style.display = 'block';
            }
        }

        function submitDetailedFeedback() {
            const feedback = document.getElementById('feedbackText').value;
            if (feedback.trim()) {
                alert(`Thanks for the detailed feedback: "${feedback}". This really helps us improve!`);
                // Hide the feedback section
                document.querySelector('[style*="background: #f8f9fa"]').style.display = 'none';
            } else {
                alert('Please enter some feedback to help us improve.');
            }
        }

        function generateFlashcards(flashcardData) {
            const container = document.getElementById('flashcardsResults');
            let html = '';
            
            flashcardData.forEach((card, index) => {
                html += `
                    <div class="flashcard" onclick="flipCard(${index})">
                        <div class="flashcard-inner" id="card-${index}">
                            <div class="flashcard-front">
                                <div>${card.front}</div>
                                <div class="flip-hint">Click to flip</div>
                            </div>
                            <div class="flashcard-back">
                                <div>${card.back}</div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            updateProgressRing();
        }

        function flipCard(index) {
            const card = document.getElementById(`card-${index}`).parentElement;
            card.classList.toggle('flipped');
            
            if (!reviewedCards.has(index)) {
                reviewedCards.add(index);
                card.classList.add('reviewed');
                updateCardProgress();
                updateProgressRing();
                
                // Add a subtle success animation
                setTimeout(() => {
                    if (card.classList.contains('flipped')) {
                        card.style.animation = 'none';
                        card.offsetHeight; // Trigger reflow
                        card.style.animation = 'flashSuccess 0.6s ease-out';
                    }
                }, 400);
            }
        }

        function updateCardProgress() {
            const progress = document.getElementById('cardProgress');
            const total = 10;
            const reviewed = reviewedCards.size;
            progress.textContent = `${reviewed}/${total} cards reviewed`;
            
            if (reviewed === total) {
                progress.innerHTML = `🎉 All ${total} cards completed!`;
                progress.style.color = '#28a745';
                progress.style.fontWeight = 'bold';
            }
        }

        function updateProgressRing() {
            const ring = document.getElementById('progressRing');
            const text = document.getElementById('progressText');
            const percentage = Math.round((reviewedCards.size / 10) * 100);
            const degrees = (percentage / 100) * 360;
            
            ring.style.setProperty('--progress', degrees + 'deg');
            text.textContent = percentage + '%';
            
            if (percentage === 100) {
                ring.style.background = 'conic-gradient(#28a745 0deg, #28a745 360deg)';
                text.style.color = '#28a745';
            }
        }

        function generateQuiz(quizData) {
            const container = document.getElementById('quizResults');
            quizAnswers = quizData;
            let html = '';
            
            quizData.forEach((q, qIndex) => {
                html += `
                    <div class="question">
                        <h4>Question ${qIndex + 1}: ${q.question}</h4>
                        <div class="answers">
                `;
                
                q.answers.forEach((answer, aIndex) => {
                    html += `
                        <div class="answer" onclick="selectAnswer(${qIndex}, ${aIndex})">
                            ${String.fromCharCode(65 + aIndex)}. ${answer}
                        </div>
                    `;
                });
                
                html += '</div></div>';
            });
            
            container.innerHTML = html;
            document.getElementById('checkAnswers').classList.remove('hidden');
        }

        let selectedAnswers = {};

        function selectAnswer(questionIndex, answerIndex) {
            const questionDiv = document.querySelectorAll('.question')[questionIndex];
            questionDiv.querySelectorAll('.answer').forEach(answer => {
                answer.classList.remove('selected');
            });
            
            const selectedAnswer = questionDiv.querySelectorAll('.answer')[answerIndex];
            selectedAnswer.classList.add('selected');
            
            selectedAnswers[questionIndex] = answerIndex;
        }

        function checkQuizAnswers() {
            let correct = 0;
            
            quizAnswers.forEach((q, qIndex) => {
                const questionDiv = document.querySelectorAll('.question')[qIndex];
                const answers = questionDiv.querySelectorAll('.answer');
                
                answers.forEach((answer, aIndex) => {
                    answer.classList.remove('selected');
                    if (aIndex === q.correct) {
                        answer.classList.add('correct');
                    } else if (selectedAnswers[qIndex] === aIndex) {
                        answer.classList.add('incorrect');
                    }
                });
                
                if (selectedAnswers[qIndex] === q.correct) {
                    correct++;
                }
            });
            
            const percentage = Math.round((correct / quizAnswers.length) * 100);
            document.getElementById('quizScore').innerHTML = `
                <h3>🎯 Quiz Results</h3>
                <p>You scored ${correct}/${quizAnswers.length} (${percentage}%)</p>
                <p>${percentage >= 80 ? '🎉 Excellent! You\'re ready for the next level!' : percentage >= 60 ? '👍 Good progress! Review the missed topics.' : '📚 Keep studying - you\'re building strong foundations!'}</p>
            `;
            document.getElementById('quizScore').classList.remove('hidden');
            document.getElementById('checkAnswers').classList.add('hidden');
        }

        function createManualAnswer() {
            const question = document.getElementById('customQuestion').value;
            
            if (!question.trim()) {
                alert('Please enter your math question first.');
                return;
            }
            
            const container = document.getElementById('studyPlanResults');
            container.innerHTML = `
                <h3>💭 Your Question</h3>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0; border-left: 4px solid #667eea;">
                    <p><strong>Question:</strong> "${question}"</p>
                </div>
                
                <div style="background: #e8f5e8; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <h4>💡 AI Response</h4>
                    <p>Great question! This is the type of specific help our AI will provide when fully launched. For now, here are some immediate resources:</p>
                    <ul style="margin: 15px 0;">
                        <li>📹 Try Khan Academy for video explanations</li>
                        <li>🤖 Use Photomath to scan specific problems</li>
                        <li>📚 Check your textbook's worked examples</li>
                        <li>👥 Ask your teacher or study group</li>
                    </ul>
                    <p><strong>Coming soon:</strong> Instant AI explanations for questions just like this!</p>
                </div>
            `;
            
            document.getElementById('flashcardsResults').innerHTML = '<div style="text-align: center; padding: 40px; color: #666;"><h3>🎓 Related Practice</h3><p>Flashcards and practice problems for this topic coming soon!</p></div>';
            document.getElementById('quizResults').innerHTML = '<div style="text-align: center; padding: 40px; color: #666;"><h3>🎓 Quick Quiz</h3><p>Interactive quizzes to test your understanding coming soon!</p></div>';
            
            document.getElementById('results').classList.remove('hidden');
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }

        // Action buttons
        function sharePlan() {
            if (navigator.share) {
                navigator.share({
                    title: 'My StudySparkAI Plan',
                    text: 'Check out my personalized math study plan!',
                    url: window.location.href
                });
            } else {
                navigator.clipboard.writeText(window.location.href);
                alert('Plan link copied to clipboard!');
            }
        }

        function savePlan() {
            const planData = {
                topic: currentTopic,
                plan: document.getElementById('studyPlanResults').innerHTML,
                timestamp: new Date().toISOString()
            };
            
            localStorage.setItem('studysparkPlan', JSON.stringify(planData));
            alert('📚 Study plan saved! You can access it anytime from this browser.');
        }

        function printPlan() {
            const printContent = document.getElementById('studyPlanResults').innerHTML;
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                    <head>
                        <title>StudySparkAI Plan</title>
                        <style>
                            body { font-family: Arial, sans-serif; margin: 20px; }
                            .plan-day { margin: 15px 0; padding: 10px; border-left: 3px solid #667eea; }
                        </style>
                    </head>
                    <body>${printContent}</body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }

        // Dark mode toggle
        function toggleDarkMode() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('dark-mode');
            const toggle = document.querySelector('.dark-mode-toggle');
            toggle.textContent = isDarkMode ? '☀️' : '🌙';
            localStorage.setItem('darkMode', isDarkMode);
        }

        // Load saved dark mode preference
        window.addEventListener('load', () => {
            const savedDarkMode = localStorage.getItem('darkMode') === 'true';
            if (savedDarkMode) {
                toggleDarkMode();
            }
        });

        // Rating system
        document.querySelectorAll('.star').forEach(star => {
            star.addEventListener('click', function() {
                currentRating = parseInt(this.dataset.rating);
                updateStars();
            });
        });

        function updateStars() {
            document.querySelectorAll('.star').forEach((star, index) => {
                if (index < currentRating) {
                    star.classList.add('active');
                } else {
                    star.classList.remove('active');
                }
            });
        }

        function submitFeedback() {
            const suggestions = document.getElementById('suggestions').value;
            
            if (currentRating === 0) {
                alert('Please select a rating before submitting.');
                return;
            }
            
            alert(`🌟 Thank you for your ${currentRating}-star rating! Your feedback helps us improve StudySparkAI for all students.`);
            
            // Reset feedback
            currentRating = 0;
            updateStars();
            document.getElementById('suggestions').value = '';
        }

        function startOver() {
            // Reset form
            document.getElementById('studyForm').reset();
            document.getElementById('customTopic').value = '';
            document.getElementById('customPlan').value = '';
            
            // Reset AI typing
            document.getElementById('aiThoughts').innerHTML = '';
            
            // Hide results
            document.getElementById('results').classList.add('hidden');
            
            // Reset data
            selectedAnswers = {};
            reviewedCards.clear();
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>
</html>
